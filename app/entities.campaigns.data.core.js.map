{"version":3,"sources":["entities/campaigns/data/core.cljc"],"mappings":"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","names":["entities.campaigns.data.core/init-campaigns","example-realms","example-rulesets","example-creatures","example-domains","example-resources","cljs.core/first","entities.campaigns.data.core/get-ids-for-all-campaigns","conn","cljs.core.map","G__39088","G__39089","cljs.core/deref","datascript.core/q","var_args","G__39121","entities.campaigns.data.core/get-all-campaigns","js/Error","entities.campaigns.data.core.get_all_campaigns","pull-pattern","G__39136","G__39137","G__39138","datascript.core/pull-many","G__39146","entities.campaigns.data.core/get-campaign-details","campaign-id","entities.campaigns.data.core.get_campaign_details","G__39165","G__39166","G__39167","datascript.core/pull","entities.campaigns.data.core/get-campaign-titles","G__39186","G__39187","G__39188","entities.campaigns.data.core/get-active-campaign","active-campaign-id","G__39193","G__39194","cljs.core/empty?","cljs.core/ffirst","entities.campaigns.data.core/get-active-campaign-realms","temp__5804__auto__","active-campaign-data","G__39203","G__39204","G__39205","entities.campaigns.data.core/get-active-campaign-rulesets","G__39209","G__39210","G__39211","entities.campaigns.data.core/get-campaign-active-ruleset","G__39217","G__39218","G__39219","entities.campaigns.data.core/set-campaign-active-ruleset","ruleset-id","datascript.core.transact_BANG_","entities.campaigns.data.core/get-active-campaign-creatures","G__39229","G__39230","G__39231","entities.campaigns.data.core/get-active-campaign-default-domains","G__39232","G__39233","G__39234","entities.campaigns.data.core/get-active-campaign-resources","G__39235","G__39236","G__39237","entities.campaigns.data.core/set-active-campaign"],"sourcesContent":["(ns entities.campaigns.data.core\r\n  (:require [datascript.core :as ds]))\r\n\r\n(defn init-campaigns\r\n  [example-realms example-rulesets example-creatures example-domains example-resources]\r\n  [{:entity-type \"campaign\"\r\n    :title \"Fantasy\"\r\n    :campaign/realms example-realms\r\n    :campaign/rulesets example-rulesets\r\n    :campaign/creatures example-creatures\r\n    :campaign/domains example-domains\r\n    :campaign/resources example-resources\r\n    :campaign/default-ruleset (first example-rulesets)\r\n    :campaign/active-ruleset (first example-rulesets)}\r\n   {:entity-type \"campaign\"\r\n    :title \"Science Fiction\"}\r\n   {:entity-type \"campaign\"\r\n    :title \"Lovecraftian Horror\"}])\r\n\r\n(defn get-ids-for-all-campaigns [conn]\r\n  (map first (ds/q '[:find ?e :where [?e :entity-type \"campaign\"]] @conn)))\r\n\r\n(defn get-all-campaigns\r\n  ([conn]\r\n   (get-all-campaigns conn '[*]))\r\n  ([conn pull-pattern]\r\n   (ds/pull-many @conn pull-pattern (get-ids-for-all-campaigns conn))))\r\n\r\n(defn get-campaign-details\r\n  ([conn campaign-id]\r\n   (get-campaign-details conn campaign-id '[*]))\r\n  ([conn campaign-id pull-pattern]\r\n   (ds/pull @conn pull-pattern campaign-id)))\r\n\r\n(defn get-campaign-titles\r\n  [conn]\r\n  (ds/pull-many @conn '[[:title :as :title]] (get-ids-for-all-campaigns conn)))\r\n\r\n(defn get-active-campaign [conn]\r\n  (let [active-campaign-id (ds/q '[:find ?campaign \r\n                                   :where [?eid :active/campaign ?campaign]]\r\n                                 @conn)]\r\n    (when-not (empty? active-campaign-id)\r\n      (get-campaign-details conn (ffirst active-campaign-id)))))\r\n\r\n(defn get-active-campaign-realms\r\n  [conn]\r\n  (when-let [active-campaign-data (get-active-campaign conn)]\r\n    (ds/pull-many @conn '[*] (:campaign/realms active-campaign-data))))\r\n\r\n(defn get-active-campaign-rulesets\r\n  [conn]\r\n  (when-let [active-campaign-data (get-active-campaign conn)]\r\n    (ds/pull-many @conn '[*] (:campaign/rulesets active-campaign-data))))\r\n\r\n(defn get-campaign-active-ruleset\r\n  [conn]\r\n  (when-let [active-campaign-data (get-active-campaign conn)]\r\n    (ds/pull @conn '[*] (:campaign/active-ruleset active-campaign-data))))\r\n\r\n(defn set-campaign-active-ruleset\r\n  [conn ruleset-id]\r\n  (when-let [active-campaign-id (:db/id (get-active-campaign conn))]\r\n    (ds/transact! conn [{:db/id active-campaign-id\r\n                         :campaign/active-ruleset ruleset-id}])))\r\n\r\n(defn get-active-campaign-creatures\r\n  [conn]\r\n  (when-let [active-campaign-data (get-active-campaign conn)]\r\n    (ds/pull-many @conn '[*] (:campaign/creatures active-campaign-data))))\r\n\r\n(defn get-active-campaign-default-domains\r\n  [conn]\r\n  (when-let [active-campaign-data (get-active-campaign conn)]\r\n    (ds/pull-many @conn '[*] (:campaign/domains active-campaign-data))))\r\n\r\n(defn get-active-campaign-resources\r\n  [conn]\r\n  (when-let [active-campaign-data (get-active-campaign conn)]\r\n    (ds/pull-many @conn '[*] (:campaign/resources active-campaign-data))))\r\n\r\n(defn set-active-campaign [conn campaign-id]\r\n  (ds/transact! conn [{:db/id -1\r\n                       :active/campaign campaign-id}]))\r\n"]}